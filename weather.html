<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="Description" content="Enter your description here" />
    <!-- 
    <link rel="stylesheet" href="style.css" />
    -->
    <link rel="stylesheet" href="./assets/reset.css" />
    <link rel="stylesheet" href="./assets/style.css" />
    <title>OpenWeather API Interface Resources</title>
  </head>

  <body class="weather-body">

    <!-- -->
    <header></header>
    <div class="mainPageContainer">
      <h1 style="text-align: center; -webkit-text-stroke: 2px black">
        ðŸŒžCamping Trip PlanningðŸŒž
      </h1>
      <div class="sectionContainer">
        <div class="sectionHeader">
          <br />  <!-- intentional space -->          
          <h2 style="text-align: center; font-size: 25px; margin-top: 15px;">Weather Forecast</h2>
          <br />  <!-- intentional space -->
          <br />  <!-- intentional space -->
          <p
          id="weather-note"
          style="font-weight: bolder; color: white; text-align: center"
        >
          Latitude:&nbsp<input id="campsiteLocationLatitude" style="width: 15ch"/>
          <!-- default: value="39.742043" for Denver -->
          &nbsp&nbsp&nbsp&nbsp&nbsp <!-- non-breaking space separator -->
          Longitude:&nbsp<input id="campsiteLocationLongitude" style="width: 15ch"/>
          <!-- default: value="-104.991531" for Denver -->
        </p>
        <p
          id="weather-note"
          style="font-weight: bolder; color: white; text-align: center"
        >
          <span style="color: blue">Note:</span> The forecast search is based 
          on campsite latitude and longitude coordinates which auto-import from
          the Project Camp website application, but you can enter your own
          search coordinates (if known) for other location searches.
        </p>
          <br />  <!-- intentional space -->
          <div id="buttonArea" style="align-items: center">
          <br />  <!-- intentional space -->
          </div>
          <div
            id="displaySectionForCampsiteWeatherInformation"
            style="display: flex; justify-content: center; margin: -15px"
          >
            <div>
              <textarea
                id="displayAreaForCampsiteWeatherInformation"
                readonly
                style="

                  width: 425px;
                  height: 350px;
                  padding: 30px;
                  margin-bottom: 20px;
                  background-color: white;
                  color: black;
                  border: 10px double darkblue;
                "
              >
              </textarea>
            </div>
          </div>
          <div>
            <p style="text-align: center">
              <button
                id="submitWeatherApiInformation"
                style="
                  text-align: center;
                  font-weight: bold;
                  padding: 10px;
                  border: 5px double orange;
                  color: white;
                  border-radius: 15px;
                  margin: 10px;
                "
                onclick="getCampsiteWeatherForecastAPI()"
              >
                Get 5-Day Weather Forecast For The User-Specified Coordinates (if any) At Above
              </button>
            </p>
            <br />  <!-- intentional space -->
            <br />  <!-- intentional space -->
            <p style="text-align: center">
              <button
                id="goBackToProjectCampWebpage"
                style="
                  text-align: center;
                  font-weight: bold;
                  padding: 10px;
                  border: 5px double orange;
                  color: white;
                  border-radius: 15px;
                "
                onclick="goBackToTheProjectCampWebpage()"
              >
                Go Back To The Project Camp Webpage
              </button>
            </p>
            <br />  <!-- intentional space -->
            <br />  <!-- intentional space -->
            </p>
              <!-- /////////////////////////////////////////////////////////////////////////////////
                possible space for a new h1 section that is for a "Supplies" button section for linking to 
                some sporting goods supply store[s] and a hardware store; for a process for a button for 
                Scott's or Logan's "Notes -- Planning Page" enhancement feature process for the buttons of
                the record navigation area; and this section could also have a green separator banner; 
                and this section could also include a row of 3 or 4 or 5 small white div boxes that could
                be placeholders for advertisements (to show a common reality of web apps)
                   ///////////////////////////////////////////////////////////////////////////////// -->

              <!-- /////////////////////////////////////////////////////////////////////////////////
                possible space for a new h1 section that is for a "Notes" textarea and button section for 
                entering/saving/loading some campsite trip notes; for a button for Scott's or Logan's 
                "Notes -- Record Save" enhancement feature process for the buttons of the record navigation
                area; and this section could also have a green separator banner
                   ///////////////////////////////////////////////////////////////////////////////// -->
          </div>
        </div>
      </div>
    </div>
    <br />
    <br />

    <footer style="display: none">
      <br />
      <br />
    </footer>

<!-- Local JavaScript code process -->
<script>


//////////////////////////////////////////////////////
//
// a section for code for a process for a button for Scott's or Logan's "Notes -- Planning Page" enhancement
// feature process for the buttons of the record navigation area
//
// <code>
// ...
//
//////////////////////////////////////////////////////


//////////////////////////////////////////////////////
//
// a section for code for a button for Scott's or Logan's "Notes -- Record Save" enhancement feature process 
// for the buttons of the record navigation area
// 
// <code>
// ...
//
//////////////////////////////////////////////////////


//////////////////////////////////////////////////////
//
// Todd's Weather process code
//
//


// a section that is to be run for page/variable/data initialization upon page load
var campsiteLatitude = "";
var campsiteLongitude = "";
var anErrorConditionExists = false;
var aNoCoordinateCampsiteRecord = false;
var campsiteWeatherForecastDisplayArea = document.getElementById("displayAreaForCampsiteWeatherInformation");
campsiteWeatherForecastDisplayArea.innerHTML = "** PROCESSING IN-PROGRESS **";
// Load from local storage the previously-saved array variable that holds the involved selected campsite record that
// was saved by the process of the "Show 5-Day Weather Forecast" button that was clicked on the campsite record.
var selectedCampsiteRecord = JSON.parse(localStorage.getItem("ProjectCampLastSelectedCampsiteRecord"));
// Campsite Location Latitude: <input id="campsiteLocationLatitude" value="39.742043" default for Denver/>
// Campsite Location Longitude: <input id="campsiteLocationLongitude" value="-104.991531" default for Denver/>
//window.alert(selectedCampsiteRecord);
if (selectedCampsiteRecord != null) {
  var campsiteLatitude = selectedCampsiteRecord[6];
  if ((campsiteLatitude != null) && (campsiteLatitude != undefined)) {
    if (campsiteLatitude == "0") {  // a non-coordinate campsite record
      aNoCoordinateCampsiteRecord = true;
      anErrorConditionExists = false;
      campsiteLatitude = "39.742043";  // default for Denver
    }
    else {
      anErrorConditionExists = false;
    }
  }
  else { 
    anErrorConditionExists = false;
    campsiteLatitude = "39.742043";
  }
}
else {
  if (campsiteLatitude == undefined) {
    anErrorConditionExists = false;
    campsiteLatitude = "39.742043";
  }
  else {
    anErrorConditionExists = true;
    campsiteLatitude = "39.742043";
  }
}  // Display the involved selected latitude coordinate on the webpage.
document.getElementById("campsiteLocationLatitude").value = campsiteLatitude;
//
if (selectedCampsiteRecord != null) {
  var campsiteLongitude = selectedCampsiteRecord[7];
  if ((campsiteLongitude != null) && (campsiteLongitude != undefined)) {
    if (campsiteLongitude == "0") {  // a non-coordinate campsite record
      aNoCoordinateCampsiteRecord = true;
      anErrorConditionExists = false;
      campsiteLongitude = "-104.991531";  // default for Denver
    }
    else {
      anErrorConditionExists = false;
    }
  }
  else { 
    anErrorConditionExists = false;
    campsiteLongitude = "-104.991531";
  }
}
else {
  if (campsiteLongitude == undefined) {
    anErrorConditionExists = false;
    campsiteLongitude = "-104.991531";
  }
  else {
    anErrorConditionExists = true;
    campsiteLongitude = "-104.991531";
  }
}  // Display the involved selected longitude coordinate on the webpage.
document.getElementById("campsiteLocationLongitude").value = campsiteLongitude;
// Generate an initial display of weather forecast information for the selected campsite.
getCampsiteWeatherForecastAPI();


function goBackToTheProjectCampWebpage() {
//window.alert("goBackToTheProjectCampWebpage");
campsiteWeatherForecastDisplayArea.innerHTML = "";
window.location.href = "./index.html";  //  the URL of the main Project Campsite webpage
//location.replace("./index.html");   // an alternate method that seemed to not work in a function call
//window.alert("GOING BACK TO PROJECT CAMP!");
}


function getCampsiteWeatherForecastAPI() {
// Use the "OpenWeatherMap" API system to obtain a weather forecast for a selected campsite location for a 
// selected forecast time-span starting from the current date. The location is specified in the form of 
// latitude and longitude coordinates...and the time-span is between 1 and 5 days (with a default of 5). Those items 
// of information are specified by query parameters in the URL string. The necessary parameters are "&lat" for
// latitude; and "&lon" for longitude; and "&cnt" a "count" for the amounts of days for the forecasting; and 
// "&units=imperial" to indicate/use USA units of temperature measurement (Fahrenheit); and 
// "&appid=<API KEY PER ACCOUNT REGISTRATION>". The OpenWeatherMap *free* "3-hour Forecast 5 days" service option...
// which is accessed through the "Current Weather Data" option/plan is used for this data connection.
//
// https://openweathermap.org/api
//
// Available API field names and JSON format and syntax examples are documented about at the URL 
// "https://openweathermap.org/forecast5#data".
//
// Available weather symbol icon graphics that could be used for CSS styling and that are indicated in "icon" 
// data attributes of the API data are listed and described at the URL 
// "https://openweathermap.org/weather-conditions".
// 
// EXAMPLE (for Denver; Latitude/&lat: 39.742043, Longitude/&lon: -104.991531): 
// https://api.openweathermap.org/data/2.5/forecast?lat=39.742043&lon=-104.991531&cnt=5&units=imperial&appid=993d2f12ebc448e7d897eca3a201a7c2
//
campsiteLatitude = document.getElementById("campsiteLocationLatitude").value;
  // enhancement: allow on-change user entry event; instead of only auto-import of coordinate information
campsiteLongitude = document.getElementById("campsiteLocationLongitude").value;
  // enhancement: allow on-change user entry event; instead of only auto-import of coordinate information
//
// <-- FUTURE ENHANCEMENT: Add a search option that is based on city name (a parameter that the API allows for)
//
// Build the URL--including the necessary query parameters--that is required for obtaining the desired data
// from the API system.
var requestWeatherUrlBase = "https://api.openweathermap.org/data/2.5/forecast";
var weatherApiKey = "993d2f12ebc448e7d897eca3a201a7c2";
var forecastDaySpan = "40";
var requestWeatherUrl = requestWeatherUrlBase + "?" + "lat=" + campsiteLatitude + "&lon=" + campsiteLongitude + 
  "&cnt=" + forecastDaySpan + "&units=imperial" + "&appid=" + weatherApiKey;
//window.alert(requestWeatherUrl);
// Get the weather data from the API service.
campsiteWeatherForecastDisplayArea.innerHTML = "** PROCESSING IN-PROGRESS **";
getApi(requestWeatherUrl);
}


// the basic API fetch-transmit function and data response-return process function
function getApi(requestUrl) {
var data = null;
fetch(requestUrl)
.then(function (response) {
    if (response.status === 400) {
        //page_element.textContent = "FETCH ERROR: " + response.status;
        console.log(response);
    }
    return response.json();
}) .then(function(data){
campsiteWeatherForecastDisplayArea.innerHTML = "** PROCESSING IN-PROGRESS **";
console.log(data);
//
// ** NOTE/IMPORTANT: **
// All of the code/process that is in this fetch-process-response section is in this section specifically because
// the running of the code is time-dependent in that is MUST be run ONLY AFTER when the fetch response data
// has been successfully and fully received by this program. 
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Save to memory for later retrieval and accessing the array variable that holds the entire list of campsite weather
// data records that were retrieved during the current campsite weather search.
var campsiteWeatherFetchResponseDataRawObject = data; 
// Possibly at later save also to local storage.
// localStorage.setItem("campsiteWeatherFetchResponseDataRawObject", 
//   JSON.stringify(campsiteWeatherFetchResponseDataRawObject));
// read: JSON.parse(localStorage.getItem("campsiteWeatherFetchResponseDataRawObject"));
// 
// pseudo-function getCampsiteWeatherForecastText() {  
  //for processing the display text at ONLY AFTER when the data is available
// Parse-Process the raw bulk data array that was returned from the fetch query to the weather API system.
// Load from local storage for processing the array variable that holds the entire list of campsite weather
// data records that were retrieved during the current campsite weather search. Then return/send that array
// variable to the main part of the program for additional processing.   
// Use an object variable to receive the raw data-set that is from the API system.
//
// windows.alert(
//  "The weather data is now being gathered. The process might be delayed " + 
//  "depending on internet/network conditions and computer processor status " + 
//  "conditions. When the weather information is displayed at below...click "+ 
//  "the \"Get 5-Day Weather Forecast\" button at a 2nd time to check about " + 
//  "if the displayed weather information changes to a different location.");
//
var theForecastProcessing = campsiteWeatherFetchResponseDataRawObject;
// Use a set of individual data-component string variables to hold the various weather sub-array data that
// each will be converted to a string representation by using the object internal toString functions.
//window.alert("theForecastingProcessing: " + theForecastProcessing);
if (anErrorConditionExists == false) {
  //window.alert("anErrorConditionExists == false");
  var location = "";
  var the5DayForecast = "";
  //
  // Use a compilation string variable to assemble the final weather summary information that will be displayed
  // in the application to the user for the selected campsite.
  the5DayForecast = "";
  // 2 primary data-set arrays of weather data are in the response weather object array: "city" (for the location
  // attributes) and "list" (for the details of the 5 forecast days).
  //
  // Read the city/location descriptive information.
  // * "city" section of the source data
  location = theForecastProcessing.city.name; 
  //
  basePath = theForecastProcessing.list;
    // a section of API data path text that can be abbreviated in each reference
  //window.alert(basePath);
  //
  // * "list" section of the source data: forecast data-set objects/indexes 0, 1, 2, 3, 4 for the days
  //
  // a preliminary note for non-coordinate campsite records
  note = 
  "NOTE: The selected campsite record does NOT contain " + 
  "any location coordinate data. Therefore a general " + 
  "weather forecast that is for Denver Colorado is being " + 
  "provided. You can return to the involved campsite " + 
  "record and check about if a ZIP code is indicated; and " +
  "if so you can search for weather by ZIP code by using " + 
  "another weather program of your choice (such as " + 
  "\"https://www.weather.com\")." + "\n";
  //
  // Loop through the 5 days and within each day of data loop through the 3-hour sets of data
  recordDayCounter = 1;
  recordCounterTime = 0;
  for (recordCounterProcess = 0; recordCounterProcess < 39; recordCounterProcess++) { 
    // include for display only the 6:00am record and the 12:00pm record and the 6:00pm record
    //window.alert(recordDayCounter);
      //if ((recordCounterTime == 0) || (recordCounterTime == 2) || (recordCounterTime ==  4)) {
        // alternate: ((recordCounterTime == 1) || (recordCounterTime == 3) || (recordCounterTime ==  5))
        // an experimented-with search-reduction method that would exclude certain time/weather data that
        // was not applicable to the trip (such as very early and very late in the day) but the API data
        // seems to be based on the exact current time of information download and therefore the API 40
        // data-sets shuffle as time passes and therefore the isolation data-set numbers also change and 
        // cannot easily be isolated without tediously evaluating the time component of each time data
        // element
      if ((((basePath[recordCounterProcess].dt_txt).indexOf("06:00:00")) >= 0) || 
        (((basePath[recordCounterProcess].dt_txt).indexOf("12:00:00")) >= 0) || 
        (((basePath[recordCounterProcess].dt_txt).indexOf("18:00:00")) >= 0)) {
        //window.alert(basePath[recordCounterProcess].dt_txt);
        the5DayForecast = the5DayForecast + 
        location + "\n" + 
        "=================================" + "\n" + 
        //"DAY " + recordDayCounter + " FORECAST FOR" + "\n" + 
        "MORNING-MIDDAY-EVENING TIME" + "\n" + 
        "WEATHER FORECAST INFORMATION:" + "\n" + 
        "for Date/Time: " + basePath[recordCounterProcess].dt_txt + "\n" + 
        "---------------------------------------------------------" + "\n" + 
        "Temperature: " + basePath[recordCounterProcess].main.temp + "F" + "\n" + 
        "Temperature-Minimum: " + basePath[recordCounterProcess].main.temp_min + "F" + "\n" + 
        "Temperature-Maximum: " + basePath[recordCounterProcess].main.temp_max + "F" + "\n" + 
        "Description1: " + basePath[recordCounterProcess].weather[0].main + "\n" + 
        "Description2: " + basePath[recordCounterProcess].weather[0].description + "\n" + 
        "Clouds: " + basePath[recordCounterProcess].clouds.all + "%" + "\n" + 
        "Wind: " + basePath[recordCounterProcess].wind.speed + " MPH" + "\n" + 
        "Visibility: " + basePath[recordCounterProcess].visibility + " Yards" + "\n" + 
        "Humidity: " + basePath[recordCounterProcess].main.humidity + "%" + "\n" +
        "Pressure: " + basePath[recordCounterProcess].main.pressure + " hPa" + "\n" + 
        "Graphics Icon File: " + basePath[recordCounterProcess].weather[0].icon + "\n" + 
        "Latitude: " + theForecastProcessing.city.coord.lat + "\n" + 
        "Longitude: " + theForecastProcessing.city.coord.lon + "\n" + 
        "=================================" + "\n" + 
        "\n" + 
        "\n";
      }  // the end-brace that is for the activate string-search data-reduction/isolation "for" loop that is at above
    //}  // the end-brace that is for the commented-out data-reduction/isolation "for" loop that is at above
    if (recordCounterTime == 7) {
      // to the next day group record of 8 3-hour-span weather records for the involved day
      // other fun related math: Math.ceil((recordDayCounter + 1) / 8); (recordCounterProcess % 8 == 0) {  /
      recordCounterTime = 0;
      recordDayCounter++;
    }
    else {
      recordCounterTime++;  // to the next 3-hour-span weather record in the group of 8 records for each day
    } 
  }  // to the next record in the set of all of the 40 records that were downloaded from the API service
  //
  //
  // Format the processed API data information summary compilation string value for display.
  // Use a different for-display compilation string variable that will contain all of the processed
  // sub-string variables elements.
  //
  // the 5=Day Forecast
  if (aNoCoordinateCampsiteRecord == true) {
    the5DayForecast = 
    note + "\n" + 
    "\n" + 
    the5DayForecast;
  }
  else {
    // the5DayForecast as-is
  }
  //
  // Continue the status display when the API process is processing so the user can see the processing if it is
  // delayed.
  var countdownTimer = 1;
  initializationInterval = setInterval(function() {
    countdownTimer--;
    if (countdownTimer <= 0 ) {
      clearInterval(initializationInterval);
      // Display the resulting weather data.
      displayAreaForCampsiteWeatherInformation.innerHTML = the5DayForecast;
    }
  }, 1000);
  //
  // POSSIBLE OPTION FOR A FUTURE ENHANCEMENT/EXPANSION:
  // Save the generated weather forecast information to local storage for possible later access/viewing.  
  // localStorage.setItem("ProjectCampCampsite5DayForecast", JSON.stringify(the5DayForecast));
  // <variable>=JSON.parse(localStorage.getItem("ProjectCampCampsite5DayForecast"));  // for possible re-loading
} // END: "anErrorConditionExists" if
else {
  displayAreaForCampsiteWeatherInformation.innerHTML = "ERROR: " + requestWeatherUrl
}  // END: "anErrorConditionExists" if-else
});  // END: fetch-response data-then
}  // END: "getCampsiteWeatherForecastAPI" function
// END: fetch-process-response section
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////


//
//
// END: Todd's Weather process code
//
//////////////////////////////////////////////////////


</script>

</body>

</html>


<!--


[ WEATHER API INFORMATION ]:


OpenWeather: https://openweathermap.org/api

https://openweathermap.org/api/one-call-3
https://api.openweathermap.org/data/3.0/onecall?lat={lat}&lon={lon}&exclude={part}&appid={API key}

--

ERROR INFORMATION: https://openweathermap.org/faq#error401

// Available API field names and JSON format and syntax examples are documented about at the URL 
// "https://openweathermap.org/forecast5#data".
//
// Available weather symbol icon graphics that could be used for CSS styling and that are indicated in "icon" 
// data attributes of the API data are listed and described at the URL 
// "https://openweathermap.org/weather-conditions".

5 day forecast is available at any location on the globe. It includes weather forecast data with 3-hour step. Forecast is available in JSON or XML format.

Call 5 day / 3 hour forecast data
How to make an API call
You can search weather forecast for 5 days with data every 3 hours by geographic coordinates. All weather data can be obtained in JSON and XML formats.

API call

api.openweathermap.org/data/2.5/forecast?lat={lat}&lon={lon}&appid={API key}

Parameters
lat, lon	required	Geographical coordinates (latitude, longitude). If you need the geocoder to automatic convert city names and zip-codes to geo coordinates and the other way around, please use our Geocoding API.
appid	required	Your unique API key (you can always find it on your account page under the "API key" tab)
units	optional	Units of measurement. standard, metric and imperial units are available. If you do not use the units parameter, standard units will be applied by default. Learn more
mode	optional	Response format. JSON format is used by default. To get data in XML format use mode=xml. Learn more
cnt	optional	A number of timestamps, which will be returned in the API response. Learn more
units	optional	Units of measurement. standard, metric and imperial units are available. If you do not use the units parameter, standard units will be applied by default. Learn more
lang	optional	You can use the lang parameter to get the output in your language. Learn more
Please use Geocoder API if you need automatic convert city names and zip-codes to geo coordinates and the other way around.

Please note that built-in geocoder has been deprecated. Although it is still available for use, bug fixing and updates are no longer available for this functionality.

Examples of API calls

https://api.openweathermap.org/data/2.5/forecast?lat=44.34&lon=10.99&appid={API key}


Weather fields in API response
If you do not see some of the parameters in your API response it means that these weather phenomena are just not happened for the time of measurement for the city or location chosen. Only really measured or calculated data is displayed in API response.

Format
Response format. JSON format is used by default. To get data in XML format use mode=xml.

Parameters
mode	optional	Response format. JSON format is used by default. To get data in XML format use mode=xml.
Examples of API calls

  
Fields in API response

cod Internal parameter
message Internal parameter
cntA number of timestamps returned in the API response
list
list.dt Time of data forecasted, unix, UTC
list.main
list.main.temp Temperature. Unit Default: Kelvin, Metric: Celsius, Imperial: Fahrenheit.
list.main.feels_like This temperature parameter accounts for the human perception of weather. Unit Default: Kelvin, Metric: Celsius, Imperial: Fahrenheit.
list.main.temp_min Minimum temperature at the moment of calculation. This is minimal forecasted temperature (within large megalopolises and urban areas), use this parameter optionally. Unit Default: Kelvin, Metric: Celsius, Imperial: Fahrenheit.
list.main.temp_max Maximum temperature at the moment of calculation. This is maximal forecasted temperature (within large megalopolises and urban areas), use this parameter optionally. Unit Default: Kelvin, Metric: Celsius, Imperial: Fahrenheit.
list.main.pressure Atmospheric pressure on the sea level by default, hPa
list.main.sea_level Atmospheric pressure on the sea level, hPa
list.main.grnd_level Atmospheric pressure on the ground level, hPa
list.main.humidity Humidity, %
list.main.temp_kf Internal parameter
list.weather
list.weather.id Weather condition id
list.weather.main Group of weather parameters (Rain, Snow, Extreme etc.)
list.weather.description Weather condition within the group. You can get the output in your language. Learn more.
list.weather.icon Weather icon id
list.clouds
list.clouds.all Cloudiness, %
list.wind
list.wind.speed Wind speed. Unit Default: meter/sec, Metric: meter/sec, Imperial: miles/hour.
list.wind.deg Wind direction, degrees (meteorological)
list.wind.gust Wind gust. Unit Default: meter/sec, Metric: meter/sec, Imperial: miles/hour
list.visibility Average visibility, metres. The maximum value of the visibility is 10km
list.pop Probability of precipitation. The values of the parameter vary between 0 and 1, where 0 is equal to 0%, 1 is equal to 100%
list.rain
list.rain.3h Rain volume for last 3 hours, mm
list.snow
list.snow.3h Snow volume for last 3 hours
list.sys
list.sys.pod Part of the day (n - night, d - day)
list.dt_txt Time of data forecasted, ISO, UTC
city
city.id City ID. Please note that built-in geocoder functionality has been deprecated. Learn more here.
city.name City name. Please note that built-in geocoder functionality has been deprecated. Learn more here.
city.coord
city.coord.lat City geo location, latitude
city.coord.lon City geo location, longitude
city.country Country code (GB, JP etc.). Please note that built-in geocoder functionality has been deprecated. Learn more here.
city.population City population
city.timezone Shift in seconds from UTC
city.sunrise Sunrise time, Unix, UTC
city.sunset Sunset time, Unix, UTC

Min/max temperature in current weather API and forecast API
Please, do not confuse min/max parameters in our weather APIs.
In 5 day / 3 hour forecast API, Hourly forecast API and Current weather API - temp_min and temp_max are optional parameters mean min / max temperature in the city at the current moment just for your reference. For large cities and megalopolises geographically expanded it might be applicable. In most cases both temp_min and temp_max parameters have the same volume as 'temp'. Please, use temp_min and temp_max parameters in current weather API optionally.
In 16 Day forecast - min and max mean maximum and minimum temperature in the day.
Current Weather API response                    

                    
For comparison take a look at example of Daily Forecast Weather API response:

Daily Forecast Weather API response   

Date and Time:

"dt":1406080800,
"temp":{
        "day":297.77,  //daily averaged temperature
        "min":293.52, //daily min temperature
        "max":297.77, //daily max temperature
        "night":293.52, //night temperature
        "eve":297.77, //evening temperature
        "morn":297.77}, //morning temperature

Please note that API requests by city name, zip-codes and city id have been deprecated. Although they are still available for use, bug fixing and updates are no longer available for this functionality.

The "dt_txt" data element has a formatted Date and Time value; 8 3-hour span records per day.


JSON
Example of API response

{
  "cod": "200",
  "message": 0,
  "cnt": 40,
  "list": [
    {
      "dt": 1661871600,
      "main": {
        "temp": 296.76,
        "feels_like": 296.98,
        "temp_min": 296.76,
        "temp_max": 297.87,
        "pressure": 1015,
        "sea_level": 1015,
        "grnd_level": 933,
        "humidity": 69,
        "temp_kf": -1.11
      },
      "weather": [
        {
          "id": 500,
          "main": "Rain",
          "description": "light rain",
          "icon": "10d"
        }
      ],
      "clouds": {
        "all": 100
      },
      "wind": {
        "speed": 0.62,
        "deg": 349,
        "gust": 1.18
      },
      "visibility": 10000,
      "pop": 0.32,
      "rain": {
        "3h": 0.26
      },
      "sys": {
        "pod": "d"
      },
      "dt_txt": "2022-08-30 15:00:00"
    },
    {
      "dt": 1661882400,
      "main": {
        "temp": 295.45,
        "feels_like": 295.59,
        "temp_min": 292.84,
        "temp_max": 295.45,
        "pressure": 1015,
        "sea_level": 1015,
        "grnd_level": 931,
        "humidity": 71,
        "temp_kf": 2.61
      },
      "weather": [
        {
          "id": 500,
          "main": "Rain",
          "description": "light rain",
          "icon": "10n"
        }
      ],
      "clouds": {
        "all": 96
      },
      "wind": {
        "speed": 1.97,
        "deg": 157,
        "gust": 3.39
      },
      "visibility": 10000,
      "pop": 0.33,
      "rain": {
        "3h": 0.57
      },
      "sys": {
        "pod": "n"
      },
      "dt_txt": "2022-08-30 18:00:00"
    },
    {
      "dt": 1661893200,
      "main": {
        "temp": 292.46,
        "feels_like": 292.54,
        "temp_min": 290.31,
        "temp_max": 292.46,
        "pressure": 1015,
        "sea_level": 1015,
        "grnd_level": 931,
        "humidity": 80,
        "temp_kf": 2.15
      },
      "weather": [
        {
          "id": 500,
          "main": "Rain",
          "description": "light rain",
          "icon": "10n"
        }
      ],
      "clouds": {
        "all": 68
      },
      "wind": {
        "speed": 2.66,
        "deg": 210,
        "gust": 3.58
      },
      "visibility": 10000,
      "pop": 0.7,
      "rain": {
        "3h": 0.49
      },
      "sys": {
        "pod": "n"
      },
      "dt_txt": "2022-08-30 21:00:00"
    },
    ....
    {
      "dt": 1662292800,
      "main": {
        "temp": 294.93,
        "feels_like": 294.83,
        "temp_min": 294.93,
        "temp_max": 294.93,
        "pressure": 1018,
        "sea_level": 1018,
        "grnd_level": 935,
        "humidity": 64,
        "temp_kf": 0
      },
      "weather": [
        {
          "id": 804,
          "main": "Clouds",
          "description": "overcast clouds",
          "icon": "04d"
        }
      ],
      "clouds": {
        "all": 88
      },
      "wind": {
        "speed": 1.14,
        "deg": 17,
        "gust": 1.57
      },
      "visibility": 10000,
      "pop": 0,
      "sys": {
        "pod": "d"
      },
      "dt_txt": "2022-09-04 12:00:00"
    }
  ],
  "city": {
    "id": 3163858,
    "name": "Zocca",
    "coord": {
      "lat": 44.34,
      "lon": 10.99
    },
    "country": "IT",
    "population": 4593,
    "timezone": 7200,
    "sunrise": 1661834187,
    "sunset": 1661882248
  }
}
      

Built-in API request by city name
You can search weather forecast for 5 days with data every 3 hours by city name. All weather data can be obtained in JSON and XML formats.

API call

api.openweathermap.org/data/2.5/forecast?q={city name}&appid={API key}

api.openweathermap.org/data/2.5/forecast?q={city name},{country code}&appid={API key}

api.openweathermap.org/data/2.5/forecast?q={city name},{state code},{country code}&appid={API key}

Parameters
q	required	City name, state code and country code divided by comma, use ISO 3166 country codes.
You can specify the parameter not only in English. In this case, the API response should be returned in the same language as the language of requested location name if the location is in our predefined list of more than 200,000 locations.

appid	required	Your unique API key (you can always find it on your account page under the "API key" tab)
mode	optional	Response format. JSON format is used by default. To get data in XML format use mode=xml. Learn more
cnt	optional	A number of timestamps, which will be returned in the API response. Learn more
units	optional	Units of measurement. standard, metric and imperial units are available. If you do not use the units parameter, standard units will be applied by default. Learn more
lang	optional	You can use the lang parameter to get the output in your language. Learn more
Examples of API calls

api.openweathermap.org/data/2.5/forecast?q=London,us&mode=xml&appid={API key}


Please note, that searching by states available only for the USA locations.
There is a possibility to receive a central district of the city/town with its own parameters (geographic coordinates/id/name) in API response. Please see the example below.

api.openweathermap.org/data/2.5/forecast?q=MÃ¼nchen,DE&appid={API key}


Built-in API request by city ID
You can search weather forecast for 5 days with data every 3 hours by city ID. All weather data can be obtained in JSON and XML formats.

List of city ID "city.list.json.gz" can be downloaded here.

We recommend to call API by city ID to get unambiguous result for your city.

API call

api.openweathermap.org/data/2.5/forecast?id={city ID}&appid={API key}

Parameters
id	required	City ID. The list of city IDs 'city.list.json.gz' can be downloaded here.
appid	required	Your unique API key (you can always find it on your account page under the "API key" tab)
mode	optional	Response format. JSON format is used by default. To get data in XML format use mode=xml. Learn more
cnt	optional	A number of timestamps, which will be returned in the API response. Learn more
units	optional	Units of measurement. standard, metric and imperial units are available. If you do not use the units parameter, standard units will be applied by default. Learn more
lang	optional	You can use the lang parameter to get the output in your language. Learn more
Examples of API calls

api.openweathermap.org/data/2.5/forecast?id=524901&appid={API key}


Built-in API request by ZIP code
Please note if country is not specified then the search works for USA as a default.

API call

api.openweathermap.org/data/2.5/forecast?zip={zip code},{country code}&appid={API key}

Parameters
zip	required	Zip code
appid	required	Your unique API key (you can always find it on your account page under the "API key" tab)
mode	optional	Response format. JSON format is used by default. To get data in XML format use mode=xml. Learn more
cnt	optional	A number of timestamps, which will be returned in the API response. Learn more
units	optional	Units of measurement. standard, metric and imperial units are available. If you do not use the units parameter, standard units will be applied by default. Learn more
lang	optional	You can use the lang parameter to get the output in your language. Learn more
Examples of API calls

api.openweathermap.org/data/2.5/forecast?zip=94040,us&appid={API key}

                    
Limitation of result
To limit number of timestamps in the API response please setup cnt.

Parameters
cnt	optional	A number of timestamps, which will be returned in the API response.
Examples of API calls

https://api.openweathermap.org/data/2.5/forecast?lat=57&lon=-2.15&cnt=3&appid={API key}


Units of measurement
standard, metric, and imperial units are available.

Parameters
units	optional	Units of measurement. standard, metric and imperial units are available. If you do not use the units parameter, standard units will be applied by default
Temperature is available in Fahrenheit, Celsius and Kelvin units.
For temperature in Fahrenheit use units=imperial
For temperature in Celsius use units=metric
Temperature in Kelvin is used by default, no need to use units parameter in API call
List of all API parameters with units openweathermap.org/weather-data

Examples of API calls

Standard

https://api.openweathermap.org/data/2.5/forecast?lat=57&lon=-2.15&appid={API key}


Metric

https://api.openweathermap.org/data/2.5/forecast?lat=57&lon=-2.15&appid={API key}&units=metric


Imperial

https://api.openweathermap.org/data/2.5/forecast?lat=57&lon=-2.15&appid=
{API key}&units=imperial


Bulk downloading
We provide number of bulk files with current weather and forecasts. More information is on the Bulk page.

Bulk downloading is available not for all accounts. To get more information please refer to the Price page.
Examples of bulk files

http://bulk.openweathermap.org/sample/ 


-->



